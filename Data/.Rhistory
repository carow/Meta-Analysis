abline(fmt1, col="red")
plot(Girth, Volume, data=dataframe)
View(dataframe)
fmt1 = lm(Volume ~ Girth, data = dataframe)
plot(Girth, Volume, data = dataframe)
abline(fmt1, col="red")
fmt1 = lm(Volume ~ Girth, data=dataframe)
summary(fmt1)
anova(fmt1)
plot(Girth, Volume, data=dataframe)
abline(fmt1, col="red")
library(MASS)
data(trees)
dataframe=trees
dataframe$Girth2 = dataframe$Girth^2
head(trees)
fmt1 = lm(Volume ~ Girth, data=dataframe)
summary(fmt1)
anova(fmt1)
plot(Girth, Volume, data=dataframe)
fmt1 = lm(Volume ~ Girth, data = dataframe)
summary(fmt1)
anova(fmt1)
plot(Girth, Volume, data = dataframe)
plot(Girth, Volume)
abline(fmt1, col="red")
fmt2 = lm(Volume ~ Girth + Girth2, data=dataframe)
summary(fmt2)
anova(fmt2)
girthvalues = seq(0, 21, 0.1)
predictedvolume <- predict(fmt2, list(Girth=girthvalues, Girth2=girthvalues^2))
plot(Girth, Volume, pch=16)
lines(girthvalues, predictedvolume, col="red")
View(dataframe)
fmt1 = lm(Volume ~ Girth)
summary(fmt1)
anova(fmt1)
plot(Girth, Volume)
abline(fmt1, col="red")
library(MASS)
data(trees)
head(trees)
# Simple linear regression model with ANOVA table and plot.
fmt1 = lm(Volume ~ Girth)
summary(fmt1)
anova(fmt1)
plot(Girth, Volume)
abline(fmt1, col="red")
knitr.table.format
knitr.table.format
install.packages(booktabs)
install.packages("booktabs")
?booktabs
library(booktabs)
install.packages("booktabs")
install.packages("printr")
?kable
library(metafor)
data("dat.bcg")
print(dat.bcg, row.names = FALSE)
summary("dat.bcg")
res<-rma(measure="RR", ai=tpos, bi=tneg, ci=cpos, di=cneg, data=dat.bcg, method="DL", slab=paste(author, year, sep=", "))
res
#DL method is according to p. 1991 metafor, for inverse variance weights.
forest(res)
#indicative for publication bias
funnel(res)
#test for funnel plot assymetry
ranktest(res)
regtest(res)
#Fail safe n for publication bias
dat <- escalc(measure="RR", ai=tpos, bi=tneg, ci=cpos, di=cneg, data=dat.bcg)
fsn(yi, vi, data=dat) #By default the Rosentahl Approach "file drawer analysis"
#sensitivity analysis/robustness test
res<-rma(measure="RR", ai=tpos, bi=tneg, ci=cpos, di=cneg, data=dat.bcg, method="DL", slab=paste(author, year, sep=", ", showweight = T))
res
forest(res)
res<-rma(measure="RR", ai=tpos, weights, bi=tneg, ci=cpos, di=cneg, data=dat.bcg, method="DL", slab=paste(author, year, sep=", ", showweight = T))
summary("dat.bcg")
print(dat.bcg, row.names = FALSE)
View(dat.bcg)
View(dat)
?dat.bcg
res <- rma(yi, vi, data=dat)
res
predict(res, transf=exp)
forest(res)
res <- rma(yi, vi, weights, data=dat)
res
predict(res, transf=exp)
forest(res)
forest(res, weights=T)
Gibson <- read.csv("~/Documents/Uni Freiburg/Best Practice R/Meta-Analysis/Data/Gibson.csv", sep=";")
View(Gibson)
View(Gibson)
?compute.es
??compute.es
setwd("/Users/Torfinn/Documents/Uni Freiburg/Best Practice R/Meta-Analysis/Data")
setwd("/Users/Torfinn/Documents/Uni Freiburg/Best Practice R/Meta-Analysis/Data")
table1 <- read.csv2("Gibson.csv")
table1$d.mean=as.numeric(table1$d.mean)
table1$p.mean=as.numeric(table1$p.mean)
table1$p.sd=as.numeric(table1$p.sd)
table1$d.sd=as.numeric(table1$d.sd)
table1$hedges.g.=as.numeric(table1$hedges.g)
attach(table1)
birds=table1[taxon=="b",-c(5,6,7,8,9,10,11,12,13)]
detach(table1)
attach(birds)
library(compute.es)
#mes2 from the package compute.es
SDpooled = sqrt(((p.n-1)*p.sd^2+(d.n-1)*d.sd^2)/(p.n+d.n-2))
str(SDpooled)
effectsizes=mes2(m.1=p.mean, m.2= d.mean,s.pooled=SDpooled, n.1=p.n, n.2=d.n)
detach(birds)
install.packages("compute.es")
library(compute.es)
str(SDpooled)
effectsizes=mes2(m.1=p.mean, m.2= d.mean,s.pooled=SDpooled, n.1=p.n, n.2=d.n)
View(birds)
attach(birds)
effectsizes=mes2(m.1=p.mean, m.2= d.mean,s.pooled=SDpooled, n.1=p.n, n.2=d.n)
detach(birds)
?compute.es
??compute.es
?rma
View(effectsizes)
names(effectsizes)
attach(birds)
result.md <- rma(m.1=p.mean, m.2= d.mean, sd1 = p.sd, sd2 = d.sd, n1 = p.n, n2 = d.n,
method = "FE", measure = "MD")
detach(birds)
attach(birds)
result.md <- rma(m.1 = p.mean, m.2 = d.mean, sd1 = p.sd, sd2 = d.sd, n1 = p.n, n2 = d.n,
method = "FE")
detach(birds)
View(effectsizes)
View(birds)
result.md <- rma(m.1 = p.mean, m.2 = d.mean, sd1 = p.sd, sd2 = d.sd, n1 = p.n, n2 = d.n,
method = "FE", measure = "MD", data = birds)
result.md <- rma(m.1 = p.mean, m.2 = d.mean, method = "FE", measure = "MD", data = birds)
attach(effectsizes)
value <- fsn(y = g, v = var.g)
value
detach(effectsizes)
funnel(fsn)
res <- rma(yi=g, vi=var.g, method="DL")
attach(effectsizes)
res <- rma(yi=g, vi=var.g, method="DL")
detach(effectsizes)
res
attach(table1)
SDpooledWhole = sqrt(((p.n-1)*p.sd^2+(d.n-1)*d.sd^2)/(p.n+d.n-2))
str(SDpooled)
effectsizesWhole=mes2(m.1=p.mean, m.2= d.mean,s.pooled=SDpooled, n.1=p.n, n.2=d.n)
detach(table1)
attach(effectsizesWhole)
res <- rma(yi=g, vi=var.g, method="DL")
res
detach(effectsizesWhole)
attach(effectsizesWhole)
median(g)
ci(g)
mean(g)
trimfill(res) # Only applicable for FE or RE objects
funnel(trimfill(res))
attach(effectsizes)
res.rd <- rma(yi=g, vi=var.g, method="DL",
measure = "RD",) # Risk Differences
trimfill(res.rd) # Only applicable for FE or RE objects
funnel(trimfill(res.rd))
detach(effectsizes)
attach(effectsizes)
value <- fsn(y = g, v = var.g)
value
funnel(value <- fsn(y = g, v = var.g))
detach(effectsizes)
??ez.calc
??escalc
attach(birds)
rma(m1i=p.mean, m2i=d.mean, sd1i=p.sd, sd2i=d.sd, n1i=p.n, n2i=d.n, method = "MD")
detach(birds)
attach(birds)
escalc(m1i=p.mean, m2i=d.mean, sd1i=p.sd, sd2i=d.sd, n1i=p.n, n2i=d.n, method = "MD")
detach(birds)
attach(birds)
escalc(measure = "MN", m1i=p.mean, m2i=d.mean, sd1i=p.sd, sd2i=d.sd, n1i=p.n, n2i=d.n, method = "MD")
detach(birds)
attach(birds)
es = escalc(measure = "MN", m1i=p.mean, m2i=d.mean, sd1i=p.sd, sd2i=d.sd, n1i=p.n, n2i=d.n, method = "MD")
detach(birds)
### load data
dat <- get(data(dat.normand1999))
### calculate mean differences and corresponding sampling variances
dat <- escalc(measure="MD", m1i=m1i, sd1i=sd1i, n1i=n1i, m2i=m2i, sd2i=sd2i, n2i=n2i, data=dat)
dat
es = escalc(measure = "MN", m1i = p.mean, m2i = d.mean, sd1i = p.sd, sd2i = d.sd, n1i = p.n, n2i = d.n, method = "MD", data=birds)
attach(birds)
es = escalc(measure = "MN", m1i = p.mean, m2i = d.mean, sd1i = p.sd, sd2i = d.sd, n1i = p.n, n2i = d.n, method = "MD", data=birds)
es
detach(birds)
attach(birds)
es = escalc(measure = "MD", m1i = p.mean, m2i = d.mean, sd1i = p.sd, sd2i = d.sd, n1i = p.n, n2i = d.n, data=birds)
es
detach(birds)
names(es)
View(es)
attach(es)
result.he = rma(yi=yi, vi=vi, method ="HE")
summary(he)
detach(es)
summary(result.he)
View(es)
View(birds)
result.he
attach(es)
plot(hedges.g, yi)
plot(hedges.g., yi)
attach(birds)
rma.he = rma(method="HE", m1i = p.mean, m2i = d.mean, sd1i =
p.sd, sd2i = d.sd, n1i = p.n, n2i = d.n, data=birds)
detach(birds)
detach(birds)
View(effectsizes)
attach(birds)
rma.he = rma(method="HE", m1i = p.mean, m2i = d.mean, sd1i =
p.sd, sd2i = d.sd, n1i = p.n, n2i = d.n, measure = "MD", data=birds)
detach(birds)
print(rma.he)
attach(birds)
rma.he = rma(method="HE", m1i = p.mean, m2i = d.mean, sd1i =
p.sd, sd2i = d.sd, n1i = p.n, n2i = d.n, measure = "SMD", data=birds)
print(rma.he)
detach(birds)
attach(birds)
rma.he = rma(method="HE", m1i = d.mean, sd1i = d.sd, n1i = d.n, m2i = p.mean, sd2i = p.sd, n2i = p.n, measure = "SMD", data=birds)
print(rma.he)
detach(birds)
attach(birds)
es = escalc(measure = "SMD", m1i = d.mean, sd1i = d.sd, n1i = d.n, m2i = p.mean, sd2i = p.sd, n2i = p.n, data=birds)
es
names(es)
detach(birds)
View(es)
attach(es)
result.he = rma(yi=yi, vi=vi, method ="HE")
result.he
summary(result.he)
detach(es)
attach(birds)
es = escalc(measure = "SMD", m1i = d.mean, sd1i = d.sd, n1i = d.n, m2i = p.mean, sd2i = p.sd, n2i = p.n, data=birds)
detach(birds)
attach(birds)
rma.he = rma(method="HE", m1i = d.mean, sd1i = d.sd, n1i = d.n, m2i = p.mean, sd2i = p.sd, n2i = p.n, measure = "SMD", data=birds)
print(rma.he)
detach(birds)
attach(es)
result.he = rma(yi=yi, vi=vi, method ="HE")
result.he
summary(result.he)
detach(es)
contributions <- 1/rma.he$vi/sum(1/rma.he$vi) * 100
cbind(contributions)
barplot(contributions)
summary(result.he)
result.he$tau2 + 1.96 * c(-1, 1) * result.he$se.tau2 #95% CI
estimators <- c("HS")
taus <- sapply(estimators, function(method)
{ rma(method="HE", m1i = d.mean,
sd1i = d.sd, n1i = d.n, m2i = p.mean, sd2i = p.sd,
n2i = p.n, measure = "SMD", data=birds)
})
estimators <- c("HS")
taus <- sapply(estimators, function(method)
{ rma(method="HE", m1i = d.mean,
sd1i = d.sd, n1i = d.n, m2i = p.mean, sd2i = p.sd,
n2i = p.n, measure = "SMD", data=birds)$tau2
})
plot(y = taus, x = 1:length(taus), type = "h", pch = 19,
axes = FALSE, xlab = "Estimators")
axis(2, las = 1)
axis(1, at = 1:length(taus), lab = estimators)
estimators <- c()
taus <- sapply(estimators, function(method)
{ rma(method="HE", m1i = d.mean,
sd1i = d.sd, n1i = d.n, m2i = p.mean, sd2i = p.sd,
n2i = p.n, measure = "SMD", data=birds)$tau2
})
plot(y = taus, x = 1:length(taus), type = "h", pch = 19,
axes = FALSE, xlab = "Estimators")
axis(2, las = 1)
axis(1, at = 1:length(taus), lab = estimators)
# I2, mean differences
I2 <- with(result.he, (QE - (k - 1))/QE * 100)
I2
forest(result.he) # DEFAULT PLOT
forest(rma.he) # DEFAULT PLOT
forest(rma.he, order = "prec") # DEFAULT PLOT
forest.rma(rma.he, order = "prec") # DEFAULT PLOT
forest.rma(rma.he, order = "prec", showweight=T) # DEFAULT PLOT
#setwd("C:/Users/ICI/Desktop/MetaAnalysisD")
#setwd("C:/Users/ICI/Desktop/MetaAnalysisD")
setwd("/Users/Torfinn/Documents/Uni Freiburg/Best Practice R/Meta-Analysis/Data")
table1 <- read.csv2("Gibson.csv")
str(table1)
summary(table1)
table1$d.mean=as.numeric(table1$d.mean)
table1$p.mean=as.numeric(table1$p.mean)
table1$p.sd=as.numeric(table1$p.sd)
table1$d.sd=as.numeric(table1$d.sd)
table1$hedges.g.=as.numeric(table1$hedges.g)
attach(table1)
birds=table1[taxon=="b",-c(5,6,7,8,9,10,11,12,13)]
detach(table1)
attach(birds)
attach(birds)
es = escalc(measure = "SMD", m1i = d.mean, sd1i = d.sd, n1i = d.n, m2i = p.mean, sd2i = p.sd, n2i = p.n, data=birds)
detach(birds)
attach(birds)
rma.he = rma(method="HE", m1i = d.mean, sd1i = d.sd, n1i = d.n, m2i = p.mean, sd2i = p.sd, n2i = p.n, measure = "SMD", data=birds)
print(rma.he)
detach(birds)
attach(es)
result.he = rma(yi=yi, vi=vi, method ="HE")
result.he
summary(result.he)
detach(es)
#Plot for study contributions to the effect size
contributions <- 1/rma.he$vi/sum(1/rma.he$vi) * 100
cbind(contributions)
barplot(contributions)
#Get Between-Study Variance & Its Error
rma.he$tau2 + 1.96 * c(-1, 1) * rma.he$se.tau2 #95% CI
# I2, mean differences
# Interpretation = Percentage of "unexplained" variance
I2 <- with(rma.he, (QE - (k - 1))/QE * 100)
I2
# Thresholds For I 2
# 0% to 30% → Low
# 30% to 60% → Moderate
# 50% to 90% → Substantial
# 75% to 100% → Considerable
# Forest plot for our model:
forest.rma(rma.he, order = "prec", showweight=T) # DEFAULT PLOT
attach(birds)
library(compute.es)
#mes2 from the package compute.es
SDpooled = sqrt(((p.n-1)*p.sd^2+(d.n-1)*d.sd^2)/(p.n+d.n-2))
str(SDpooled)
effectsizesWhole=mes2(m.1=p.mean, m.2= d.mean,s.pooled=SDpooled, n.1=p.n, n.2=d.n)
detach(birds)
attach(effectsizes)
res <- rma(yi=g, vi=var.g, method="DL")
res
detach(effectsizes)
attach(effectsizes)
value <- fsn(y = g, v = var.g)
value
funnel(value <- fsn(y = g, v = var.g))
detach(effectsizes)
attach(effectsizes)
res.rd <- rma(yi=g, vi=var.g, method="DL",
measure = "RD",) # Risk Differences
trimfill(res.rd) # Only applicable for FE or RE objects
funnel(trimfill(res.rd))
detach(effectsizes)
detach(table1)
detach(birds)
detach(birds)
detach(es)
detach(es)
detach(birds)
detach(effectsizes)
detach(effectsizes)
#setwd("C:/Users/ICI/Desktop/MetaAnalysisD")
setwd("/Users/Torfinn/Documents/Uni Freiburg/Best Practice R/Meta-Analysis/Data")
table1 <- read.csv2("Gibson.csv")
str(table1)
summary(table1)
table1$d.mean=as.numeric(table1$d.mean)
table1$p.mean=as.numeric(table1$p.mean)
table1$p.sd=as.numeric(table1$p.sd)
table1$d.sd=as.numeric(table1$d.sd)
table1$hedges.g.=as.numeric(table1$hedges.g)
attach(table1)
birds=table1[taxon=="b",-c(5,6,7,8,9,10,11,12,13)]
detach(table1)
attach(birds)
es = escalc(measure = "SMD", m1i = d.mean, sd1i = d.sd, n1i = d.n, m2i = p.mean, sd2i = p.sd, n2i = p.n, data=birds)
detach(birds)
attach(birds)
rma.he = rma(method="HE", m1i = d.mean, sd1i = d.sd, n1i = d.n, m2i = p.mean, sd2i = p.sd, n2i = p.n, measure = "SMD", data=birds)
print(rma.he)
detach(birds)
attach(es)
result.he = rma(yi=yi, vi=vi, method ="HE")
result.he
summary(result.he)
detach(es)
#Plot for study contributions to the effect size
contributions <- 1/rma.he$vi/sum(1/rma.he$vi) * 100
cbind(contributions)
barplot(contributions)
#Get Between-Study Variance & Its Error
rma.he$tau2 + 1.96 * c(-1, 1) * rma.he$se.tau2 #95% CI
# I2, mean differences
# Interpretation = Percentage of "unexplained" variance
I2 <- with(rma.he, (QE - (k - 1))/QE * 100)
I2
# Thresholds For I 2
# 0% to 30% → Low
# 30% to 60% → Moderate
# 50% to 90% → Substantial
# 75% to 100% → Considerable
# Forest plot for our model:
forest.rma(rma.he, order = "prec", showweight=T) # DEFAULT PLOT
attach(birds)
library(compute.es)
#mes2 from the package compute.es
SDpooled = sqrt(((p.n-1)*p.sd^2+(d.n-1)*d.sd^2)/(p.n+d.n-2))
str(SDpooled)
effectsizes=mes2(m.1=p.mean, m.2= d.mean,s.pooled=SDpooled, n.1=p.n, n.2=d.n)
detach(birds)
attach(effectsizes)
res <- rma(yi=g, vi=var.g, method="DL")
res
detach(effectsizes)
attach(effectsizes)
value <- fsn(y = g, v = var.g)
value
funnel(value <- fsn(y = g, v = var.g))
detach(effectsizes)
attach(effectsizes)
res.rd <- rma(yi=g, vi=var.g, method="DL",
measure = "RD",) # Risk Differences
trimfill(res.rd) # Only applicable for FE or RE objects
funnel(trimfill(res.rd))
detach(effectsizes)
#setwd("C:/Users/ICI/Desktop/MetaAnalysisD")
setwd("/Users/Torfinn/Documents/Uni Freiburg/Best Practice R/Meta-Analysis/Data")
table1 <- read.csv2("Gibson.csv")
str(table1)
summary(table1)
table1$d.mean=as.numeric(table1$d.mean)
table1$p.mean=as.numeric(table1$p.mean)
table1$p.sd=as.numeric(table1$p.sd)
table1$d.sd=as.numeric(table1$d.sd)
table1$hedges.g.=as.numeric(table1$hedges.g)
attach(table1)
birds=table1[taxon=="b",-c(5,6,7,8,9,10,11,12,13)]
detach(table1)
attach(birds)
es = escalc(measure = "SMD", m1i = d.mean, sd1i = d.sd, n1i = d.n, m2i = p.mean, sd2i = p.sd, n2i = p.n, data=birds)
detach(birds)
attach(birds)
rma.he = rma(method="HE", m1i = d.mean, sd1i = d.sd, n1i = d.n, m2i = p.mean, sd2i = p.sd, n2i = p.n, measure = "SMD", data=birds)
print(rma.he)
detach(birds)
attach(es)
result.he = rma(yi=yi, vi=vi, method ="HE")
result.he
summary(result.he)
detach(es)
#Plot for study contributions to the effect size
contributions <- 1/rma.he$vi/sum(1/rma.he$vi) * 100
cbind(contributions)
barplot(contributions)
#Get Between-Study Variance & Its Error
rma.he$tau2 + 1.96 * c(-1, 1) * rma.he$se.tau2 #95% CI
# I2, mean differences
# Interpretation = Percentage of "unexplained" variance
I2 <- with(rma.he, (QE - (k - 1))/QE * 100)
I2
# Thresholds For I 2
# 0% to 30% → Low
# 30% to 60% → Moderate
# 50% to 90% → Substantial
# 75% to 100% → Considerable
# Forest plot for our model:
forest.rma(rma.he, order = "prec", showweight=T) # DEFAULT PLOT
attach(birds)
library(compute.es)
#mes2 from the package compute.es
SDpooled = sqrt(((p.n-1)*p.sd^2+(d.n-1)*d.sd^2)/(p.n+d.n-2))
str(SDpooled)
effectsizes=mes2(m.1=p.mean, m.2= d.mean,s.pooled=SDpooled, n.1=p.n, n.2=d.n)
detach(birds)
attach(effectsizes)
res <- rma(yi=g, vi=var.g, method="DL")
res
detach(effectsizes)
attach(effectsizes)
value <- fsn(y = g, v = var.g)
value
funnel(value <- fsn(y = g, v = var.g))
detach(effectsizes)
attach(effectsizes)
res.rd <- rma(yi=g, vi=var.g, method="DL",
measure = "RD",) # Risk Differences
trimfill(res.rd) # Only applicable for FE or RE objects
funnel(trimfill(res.rd))
detach(effectsizes)
attach(effectsizes)
value <- fsn(y = g, v = var.g)
value
detach(effectsizes)
attach(effectsizes)
res.rd <- rma(yi=g, vi=var.g, method="DL",
measure = "RD",) # Risk Differences
trimfill(res.rd) # Only applicable for FE or RE objects
funnel(trimfill(res.rd))
detach(effectsizes)
